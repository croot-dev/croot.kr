---
layout: post
title: "Next.js 14 App router with Ant Design 5 & Styled-Components "
created: 2023-12-18
edited: 2024-01-03
category: [ê¸°ìˆ ]
tags: [Next.js:rgb(255 226 221):rgb(93 23 21),css-in-js:rgb(255 226 221):rgb(93 23 21),Styled-Components:rgb(253 236 200):rgb(64 44 27),AppRouter:rgb(250 222 201):rgb(73 41 14)]
---


<div class="callout" style="display:flex;width:100%;border-radius:4px;background:rgb(241,241,239);padding: 16px 16px 16px 12px;">
<div style="display:flex;align-items:center;justify-content:center;height:24px;width:24px;border-radius:0.25em;flex-shrink:0;">ğŸ’¡</div>
<div style="white-space:pre-wrap;word-break:break-word;caret-color:rgb(55, 53, 47);margin-left:8px;padding-left:2px;padding-right:2px;">Next.js 14 App Router ì‚¬ìš© í™˜ê²½ì—ì„œ <code class="language-plaintext highlighter-rouge">Ant Design 5</code> ì™€ <code class="language-plaintext highlighter-rouge">Styled-Components</code> ë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.</div>
</div>


## ì„¤ì¹˜


<div class="callout" style="display:flex;width:100%;border-radius:4px;background:rgb(241,241,239);padding: 16px 16px 16px 12px;">
<div style="display:flex;align-items:center;justify-content:center;height:24px;width:24px;border-radius:0.25em;flex-shrink:0;">ğŸ’¡</div>
<div style="white-space:pre-wrap;word-break:break-word;caret-color:rgb(55, 53, 47);margin-left:8px;padding-left:2px;padding-right:2px;"><strong>ì˜ˆì œ í™˜ê²½<br /></strong>- Engine: <code class="language-plaintext highlighter-rouge">Node 18.19.0 </code><br />- Package Manager: <code class="language-plaintext highlighter-rouge">yarn 1.22.19</code>  </div>
</div>


### 1. Next.js 18 ì„¤ì¹˜


```shell
# node v.18.19.0 ì—ì„œ ì‹¤í–‰
npx create-next-app@latest
# next v14.0.4 ì„¤ì¹˜ë¨.
```


> ì°¸ê³ : [https://nextjs.org/docs/getting-started/installation](https://nextjs.org/docs/getting-started/installation)


### 2. antd ì„¤ì¹˜


```shell
yarn add antd styled-components @ant-design/cssinjs
```


### 3. í™•ì¸


styled-component ë™ì‘ í™•ì¸ì„ ìœ„í•´ ê°„ë‹¨í•˜ê²Œ **`/app/pages`** ê²½ë¡œì— ê¸€ì ìƒ‰ìƒì„ ìŠ¤íƒ€ì¼ë§ í•´ë³´ì•˜ë‹¤.


```javascript
// src/app/page.tsx

'use client';

import styled from 'styled-components'

// hotpink ê¸€ììƒ‰ ì ìš©
const CustomEl = styled.h1`
  color: hotpink;
`

export default function Home() {
  return (
    <main>
      <CustomEl>
        Get started by editing&nbsp;
        <code>src/app/page.tsx</code>
      </CustomEl>
    </main>
  )
}
```


ì ìš©ì€ ë˜ì§€ë§Œ css-in-js ëŠ” ëŸ°íƒ€ì„ì—ì„œ ìŠ¤íƒ€ì¼ì´ ìƒì„±ë˜ì§€ ì•Šì•„ ìƒˆë¡œê³ ì¹¨ ì‹œ ê¹œë¹¡ì„ì´ ë°œìƒí•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
ë˜í•œ Antd í…Œë§ˆ í† í°ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ Registryë¥¼ ì ìš©í•´ì•¼í•œë‹¤.


![0](/assets/img/2023-12-18-Next.js-14-App-router-with-Ant-Design-5-&-Styled-Components-.md/0.png)_ezgif-3-8fa65afe9e.gif_


## Theme ë° Registry ì¶”ê°€


### 1. Theme ì‘ì„±


```javascript
// src/themes/base.ts

const baseTheme = {
    token: {
      fontFamily: 'Arial',
      colorPrimary: 'hotpink',
			//...
    },
    components: {
			//...
    },
  };
  
export default baseTheme
```


### 2. Registry ì‘ì„±

1. Styled-Components Registry ì‘ì„± (ê²½ë¡œ: `src/providers/StyledComponentsRegistry.tsx`)

	```javascript
	// src/providers/StyledComponentsRegistry.tsx
	
	'use client'
	 
	import { ReactNode, useState } from 'react'
	import { useServerInsertedHTML } from 'next/navigation'
	import { ServerStyleSheet, StyleSheetManager, ThemeProvider } from 'styled-components'
	 
	const StyledComponentsRegistry = ({
	  children,
	}: {
	  children: ReactNode
	}) => {
	  const [styledComponentsStyleSheet] = useState(() => new ServerStyleSheet())
	 
	  useServerInsertedHTML(() => {
	    const styles = styledComponentsStyleSheet.getStyleElement()
	    styledComponentsStyleSheet.instance.clearTag()
	    return <>{styles}</>
	  })
	 
	  if (typeof window !== 'undefined') return <>{children}</>
	 
	  return (
	    <StyleSheetManager sheet={styledComponentsStyleSheet.instance}>
	      {children}
	    </StyleSheetManager>
	  )
	}
	
	export default StyledComponentsRegistry;
	```


	> ì°¸ê³ : [https://nextjs.org/docs/app/building-your-application/styling/css-in-js#styled-components](https://nextjs.org/docs/app/building-your-application/styling/css-in-js#styled-components)

2. Antd Registry ì‘ì„± (ê²½ë¡œ : `src/providers/AntdRegistry.tsx`)

	```javascript
	// src/providers/AntdRegistry.tsx
	
	'use client';
	
	import { StyleProvider, createCache, extractStyle } from '@ant-design/cssinjs';
	import { ConfigProvider } from 'antd';
	import { useServerInsertedHTML } from 'next/navigation';
	import { useState } from 'react';
	import baseTheme from '@/themes/base';
	
	const AntdRegistry = ({ children }: { children: React.ReactNode }) => {
	  const [cache] = useState(() => createCache());
	
	  useServerInsertedHTML(() => (
	    <style dangerouslySetInnerHTML={{ __html: extractStyle(cache, true) }} id='antd'></style>
	  ));
	
	  return (
	    <StyleProvider cache={cache}>
	      <ConfigProvider theme={baseTheme}>
	        {children}
	      </ConfigProvider>
	    </StyleProvider>
	  );
	};
	
	export default AntdRegistry
	```


	> ì°¸ê³ : [https://ant.design/docs/react/use-with-next#using-app-router](https://ant.design/docs/react/use-with-next#using-app-router)

3. Registry ì ìš©

	```javascript
	// src/app/layout.tsx
	
	import type { Metadata } from 'next'
	import { ReactNode } from 'react'
	import AntdRegistry from '@/providers/AntdRegistry'
	import StyledComponentsRegistry from '@/providers/StyledComponentsRegistry'
	
	export const metadata: Metadata = {
	  title: 'Create Next App',
	  description: 'Generated by create next app',
	}
	
	export default function RootLayout({
	  children,
	}: {
	  children: ReactNode
	}) {
	  return (
	    <html lang="en">
				{/* Antd Registry ì ìš© */}
	      <AntdRegistry>
					{/* í…Œë§ˆ ì‚¬ìš©ì„ ìœ„í•˜ì—¬ AntdRegistry ì•„ë˜ì— StyledComponentRegistryë¥¼ ë„£ì—ˆë‹¤. */}
	        <StyledComponentsRegistry>
	          <body>{children}</body>
	        </StyledComponentsRegistry>
	      </AntdRegistry>
	    </html>
	  )
	}
	```

4. í™•ì¸

	ìƒˆë¡œê³ ì¹¨ ì‹œ ê¹œë¹¡ì„ì´ ì‚¬ë¼ì§ì„ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤.


<div class="callout" style="display:flex;width:100%;border-radius:4px;background:rgb(241,241,239);padding: 16px 16px 16px 12px;">
<div style="display:flex;align-items:center;justify-content:center;height:24px;width:24px;border-radius:0.25em;flex-shrink:0;">ğŸ’¡</div>
<div style="white-space:pre-wrap;word-break:break-word;caret-color:rgb(55, 53, 47);margin-left:8px;padding-left:2px;padding-right:2px;">ìœ„ ë°©ì‹ëŒ€ë¡œ ì˜ ì•ˆëœë‹¤ë©´ ì•„ë˜ ant-design ì—ì„œ ì œê³µí•˜ëŠ” ì˜ˆì œ ì†ŒìŠ¤ë¥¼ ì´ìš©í•´ë³´ì‹œê¸¸..<br /><a href="https://github.com/ant-design/ant-design-examples/tree/main/examples" target="_blank">ğŸ”—Â ant-design ì—ì„œ ì œê³µí•˜ëŠ” ì˜ˆì œ ì†ŒìŠ¤ì½”ë“œ</a></div>
</div>


## Styled-componentsì—ì„œ Antd í…Œë§ˆ ì‚¬ìš©


styled-component ì´ìš© ì‹œ antd í…Œë§ˆ ê°’ì„ ì‚¬ìš©í•˜ê³  ì‹¶ì€ ê²½ìš° ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•˜ë©´ ëœë‹¤.


### 1. ThemeProvider ì¶”ê°€


```javascript
// src/providers/StyledComponentsRegistry.tsx

'use client'
 
//...ìƒëµ
// antd theme ì¶”ê°€
import { theme } from "antd";
 
const StyledComponentsRegistry = ({
  children,
}: {
  children: ReactNode
}) => {
	// token ì´ìš©ì„ ìœ„í•´ hook í˜¸ì¶œ 
  const { token } = theme.useToken();
  //...ì¤‘ëµ
 
  return (
    <StyleSheetManager sheet={styledComponentsStyleSheet.instance}>
			{/* Antd í…Œë§ˆ í† í° ì ìš© */}
      <ThemeProvider theme={{antd: token}}>
        {children}
      </ThemeProvider>
    </StyleSheetManager>
  )
}

export default StyledComponentsRegistry;
```


### 2. Theme í† í° ì ìš©


```javascript
// src/app/page.tsx

'use client';

import styled from 'styled-components'

const CustomEl = styled.h1`
  &&& {
    color:${({ theme })=> theme.antd?.colorPrimary};
  }
`;

export default function Home() {
  return (
      <main>
        <CustomEl>
          Get started by editing&nbsp;
          <code>src/app/page.tsx</code>
        </CustomEl>
      </main>
  )
}
```

